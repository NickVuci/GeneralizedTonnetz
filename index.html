<!DOCTYPE html>
<html>
<head>
    <title>Generalized Tonnetz</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>

<div id="controls" class="header-controls">
    <div class="controls-header">
        <div class="title-section">
            <h1 class="main-title">Generalized Tonnetz</h1>
            <h3 class="subtitle">By Nick Vuci</h3>
        </div>
        <div class="header-lattice">
            <label for="edo">EDO:</label>
            <input type="number" id="edo" value="12" min="1" max="72">
            <label for="intervalX">Interval X:</label>
            <input type="number" id="intervalX" value="7" min="-72" max="72">
            <label for="intervalZ">Interval Z:</label>
            <input type="number" id="intervalZ" value="4" min="-72" max="72">
        </div>
        <div class="header-actions">
            <button id="drawButton" class="primary-action">Draw Tonnetz</button>
            <button id="saveImageButton" class="primary-action">Save PNG</button>
            <button id="savePdfButton" class="primary-action">Save PDF</button>
        </div>
        <button id="toggleControls" class="toggle-btn">âˆ’</button>
    </div>
    <div class="controls-content" id="controlsContent">
        <fieldset>
            <legend>Size &amp; Shape</legend>
            <!-- EDO / X / Z are in the header; canvas & export controls live here -->
            <div class="control-group">
                <label for="canvasSize">Canvas Size:</label>
                <select id="canvasSize">
                    <option value="A4">A4</option>
                    <option value="A3">A3</option>
                    <option value="Letter">Letter</option>
                    <option value="Legal">Legal</option>
                    <option value="Custom" selected>Custom</option>
                </select>
                <label for="orientation">Orientation:</label>
                <select id="orientation">
                    <option value="portrait">Vertical</option>
                    <option value="landscape">Horizontal</option>
                </select>
            </div>
            <div class="control-group" id="customSizeGroup" style="display: block;">
                <label for="canvasWidth">Width (px):</label>
                <input type="number" id="canvasWidth" value="1000" min="100" max="2000">
                <label for="canvasHeight">Height (px):</label>
                <input type="number" id="canvasHeight" value="1000" min="100" max="2000">
            </div>
            <div class="control-group">
                <label for="triangleSize">Triangle Size:</label>
                <input type="number" id="triangleSize" value="75" min="10" max="200">
            </div>
        </fieldset>

        <fieldset>
            <legend>Color</legend>
            <div class="control-group">
                <label for="colorX">X Axis:</label>
                <input type="color" id="colorX" class="axis-color">
                <label for="colorY">Y Axis:</label>
                <input type="color" id="colorY" class="axis-color">
                <label for="colorZ">Z Axis:</label>
                <input type="color" id="colorZ" class="axis-color">
            </div>
            <div class="control-group">
                <label for="backgroundColor">Background:</label>
                <input type="color" id="backgroundColor">
                <label for="labelColor">Labels:</label>
                <input type="color" id="labelColor">
                <input type="checkbox" id="highlightZero" checked>
                <label for="highlightZero">Highlight "0"</label>
            </div>
        </fieldset>

        <!-- Canvas & Export fieldset removed; options moved to Lattice Parameters -->

        <!-- Overlays moved to left sidebar below -->

            <!-- Draw and Save Image moved to header -->
    </div>
</div>

<!-- Workspace: overlay sidebar on the left, canvas on the right -->
<div class="workspace">
    <aside id="overlaySidebar" class="overlay-sidebar">
        <div class="overlay-header">
            <h3>Chord Overlays</h3>
            <button id="addOverlayBtn" title="Add a new overlay with its own steps, color, and anchors">Add Overlay</button>
        </div>
        <div id="overlayList" class="overlay-list"></div>
    </aside>
    <div class="canvas-wrap">
        <canvas id="tonnetzCanvas" width="600" height="600"></canvas>
    </div>
    
</div>

<!-- Include jsPDF library for PDF saving -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<!-- App scripts split for maintainability; order matters (helpers -> geometry -> drawing -> overlays -> app) -->
<script src="helpers.js"></script>
<script src="geometry.js"></script>
<script src="drawing.js"></script>
<script src="overlays.js"></script>
<script src="app.js"></script>

</body>
</html>
